!function(m){"use strict";var r=window.minimog.Helpers;m(document).ready(function(){var s,d,u,e,t,n,o;e=m("#minimog-wc-question"),s=m(".woocommerce-noreviews",e),d=m(".question-list-container",e),u=m(".question-list",e),m(document.body).on("submit",".question-form",function(e){e.preventDefault();var n=m(this),t=n.find('button[type="submit"]'),o=m("[name=question]",n),i=parseInt(m("input[name=question_parent_id]",n).val()),a=parseInt(m(".question-count",d).html());m.ajax({url:$minimog.ajaxurl,type:"POST",cache:!1,dataType:"json",data:n.serialize(),success:function(e){var t;(e.success?(i?((t=m(".children","#li-comment-"+i)).length?t.prepend(e.data.response):(t=m('<ol class="children" />')).appendTo("#li-comment-"+i).html(e.data.response),m(document.body).trigger("minimog_product_question_child_added",[i])):(a+=1,s.length&&s.remove(),u.prepend(e.data.response)),t=1===a?e.data.single_text:e.data.plural_text,m(".question-count",d).html(a),m(".question-text",d).html(t),o.val(""),m(document.body).trigger("minimog_product_question_added",[e.data,!0]),n.find(".question-form-message-box").addClass("success")):n.find(".question-form-message-box").addClass("failed")).text(e.data.message).slideDown()},beforeSend:function(){n.find(".question-form-message-box").text("").removeClass("failed success").slideUp(),r.setElementHandling(t)},complete:function(){r.unsetElementHandling(t)}})}),m(document.body).on("click",".question-reply",function(e){e.preventDefault();var e=m(this),t=e.data("question-id"),n=m("#modal-product-question"),o=n.find(".modal-title"),i=n.find(".question-form-message-box"),a=n.find('input[name="question_parent_id"]'),e=e.closest(".comment-footer").siblings(".meta").children(".fn").text(),s=n.data("reply-title");i.removeClass("success failed").text(""),s=s.replace("{comment_author_name}",e),o.text(s),n.MinimogModal("open"),a.val(t)}),e=m("#minimog-wc-question"),t=e.closest(".minimog-tabs"),m(".question-list-container",e),n=m(".question-search-form",e),m(".question-list",e),o=m(".question-toolbar",e),n.on("submit",function(e){return e.preventDefault(),m.ajax({url:$minimog.ajaxurl,type:"GET",data:n.serialize(),dataType:"json",cache:!0,success:function(e){e.data.fragments&&(m.each(e.data.fragments,function(e,t){m(e).empty(),""!==t&&(t=m.trim(t),t=m(m.parseHTML(t)),m(e).html(t.html()))}),0<t.length&&t.MinimogTabPanel("updateLayout"),m(document.body).trigger("minimog_get_product_questions_fragments_loaded"))},beforeSend:function(){r.setBodyHandling();var e=0,t=o.offset().top;t-=e=m(document.body).hasClass("header-sticky-enable")?m("#page-header").outerHeight():e,m("html, body").animate({scrollTop:t},800)},complete:function(){r.setBodyCompleted()}}),!1}),m(document.body).on("click",".question-navigation a",function(e){e.preventDefault();e=r.getUrlParamsAsObject(m(this).attr("href")),e=e?e.current_page:1;n.find('input[name="current_page"]').val(e),n.trigger("submit")}),m(document.body).on("minimog_product_question_added",function(){var e=m("#minimog-wc-question");0<e.length&&0<(e=e.closest(".minimog-tabs")).length&&e.MinimogTabPanel("updateLayout")})})}(jQuery);