{"version":3,"sources":["avatar-upload.js"],"names":["$","document","ready","$form","$avatar","$toggleMenuBtn","$uploadWrap","$fileField","on","e","preventDefault","this","closest","removeClass","find","trigger","file","target","files","data","FormData","get","append","$minimogUpload","update_avatar_nonce","each","key","value","ajax","url","$minimog","ajaxurl","type","cache","dataType","processData","contentType","success","response","textStatus","jqXHR","newAvatar","Image","src","alt","onload","remove","beforeSend","addClass","complete","body","evt","toggleClass","jQuery"],"mappings":"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","file":"../../../woo/avatar-upload.min.js","sourcesContent":["(\n\tfunction( $ ) {\n\t\t'use strict';\n\n\t\t$( document ).ready( function() {\n\t\t\tuploadAvatar();\n\t\t\tremoveAvatar();\n\t\t\ttoggleButton();\n\t\t} );\n\n\t\tfunction toggleButton() {\n\t\t\t$( document.body ).on( 'click', '.btn-toggle-avatar-upload-menu', function( evt ) {\n\t\t\t\tevt.preventDefault();\n\n\t\t\t\t$( this ).closest( '.my-avatar' )\n\t\t\t\t         .find( '.minimog-user-profile' )\n\t\t\t\t         .find( '.minimog-user-profile__action' )\n\t\t\t\t         .toggleClass( 'active' );\n\t\t\t} );\n\t\t}\n\n\t\tfunction uploadAvatar() {\n\t\t\tvar $uploadWrap    = $( '.my-account-profile' ),\n\t\t\t    $form          = $( '.minimog-user-profile__form' ),\n\t\t\t    $avatar        = $( '.avatar', $uploadWrap ),\n\t\t\t    $toggleMenuBtn = $( '.btn-toggle-avatar-upload-menu', $uploadWrap ),\n\t\t\t    $fileField     = $( '.tm_user_avatar', $form ),\n\t\t\t    $uploadBtn     = $( '.upload_avatar', $form );\n\n\t\t\t$uploadBtn.on( 'click', function( e ) {\n\t\t\t\te.preventDefault();\n\t\t\t\t$( this ).closest( '.minimog-user-profile__action' ).removeClass( 'active' );\n\t\t\t\t$( this ).closest( '.minimog-user-profile__form' ).find( '.tm_user_avatar' ).trigger( 'click' );\n\t\t\t} );\n\n\t\t\t$fileField.on( 'change', function( e ) {\n\t\t\t\tvar file = e.target.files,\n\t\t\t\t    data = new FormData( $form.get( 0 ) );\n\n\t\t\t\tdata.append( 'action', 'minimog_upload_avatar' );\n\t\t\t\tdata.append( '_ajax_nonce', $minimogUpload.update_avatar_nonce );\n\n\t\t\t\t$.each( file, function( key, value ) {\n\t\t\t\t\tdata.append( 'user_avatar', value );\n\t\t\t\t} );\n\n\t\t\t\t$.ajax( {\n\t\t\t\t\turl: $minimog.ajaxurl,\n\t\t\t\t\ttype: 'POST',\n\t\t\t\t\tdata: data,\n\t\t\t\t\tcache: false,\n\t\t\t\t\tdataType: 'json',\n\t\t\t\t\tprocessData: false,\n\t\t\t\t\tcontentType: false,\n\t\t\t\t\tsuccess: function( response, textStatus, jqXHR ) {\n\t\t\t\t\t\tif ( response.data ) {\n\t\t\t\t\t\t\tvar newAvatar = new Image();\n\t\t\t\t\t\t\tnewAvatar.src = response.data;\n\t\t\t\t\t\t\tnewAvatar.alt = 'test';\n\n\t\t\t\t\t\t\tnewAvatar.onload = function() {\n\t\t\t\t\t\t\t\t$avatar.find( 'img' ).remove();\n\t\t\t\t\t\t\t\t$avatar.append( newAvatar );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tbeforeSend: function() {\n\t\t\t\t\t\t$toggleMenuBtn.addClass( 'updating-icon' );\n\t\t\t\t\t},\n\t\t\t\t\tcomplete: function() {\n\t\t\t\t\t\t$toggleMenuBtn.removeClass( 'updating-icon' );\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t} );\n\n\t\t\t$form.on( 'submit', function( e ) {\n\t\t\t\te.preventDefault();\n\t\t\t} );\n\t\t}\n\n\t\tfunction removeAvatar() {\n\t\t\tvar $uploadWrap    = $( '.my-account-profile' ),\n\t\t\t    $form          = $( '.minimog-user-profile__form' ),\n\t\t\t    $toggleMenuBtn = $( '.btn-toggle-avatar-upload-menu', $uploadWrap ),\n\t\t\t    $avatar        = $( '.avatar', $uploadWrap ),\n\t\t\t    $removeBtn     = $( '.remove_avatar', $form );\n\n\t\t\t$removeBtn.on( 'click', function( e ) {\n\t\t\t\te.preventDefault();\n\n\t\t\t\t$( this ).closest( '.minimog-user-profile__action' ).removeClass( 'active' );\n\n\t\t\t\tvar data = new FormData( $form.get( 0 ) );\n\n\t\t\t\tdata.append( 'action', 'minimog_remove_avatar' );\n\t\t\t\tdata.append( '_ajax_nonce', $minimogUpload.update_avatar_nonce );\n\n\t\t\t\t$.ajax( {\n\t\t\t\t\turl: $minimog.ajaxurl,\n\t\t\t\t\ttype: 'POST',\n\t\t\t\t\tdata: data,\n\t\t\t\t\tcache: false,\n\t\t\t\t\tdataType: 'json',\n\t\t\t\t\tprocessData: false,\n\t\t\t\t\tcontentType: false,\n\t\t\t\t\tsuccess: function( response, textStatus, jqXHR ) {\n\t\t\t\t\t\tif ( response.data ) {\n\t\t\t\t\t\t\tvar newAvatar = new Image();\n\t\t\t\t\t\t\tnewAvatar.src = response.data;\n\t\t\t\t\t\t\tnewAvatar.alt = 'test';\n\n\t\t\t\t\t\t\tnewAvatar.onload = function() {\n\t\t\t\t\t\t\t\t$avatar.find( 'img' ).remove();\n\t\t\t\t\t\t\t\t$avatar.append( newAvatar );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tbeforeSend: function() {\n\t\t\t\t\t\t$toggleMenuBtn.addClass( 'updating-icon' );\n\t\t\t\t\t},\n\t\t\t\t\tcomplete: function() {\n\t\t\t\t\t\t$toggleMenuBtn.removeClass( 'updating-icon' );\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t} );\n\t\t}\n\t}( jQuery )\n);\n"]}