{"version":3,"sources":["cart.js"],"names":["$","Helpers","window","minimog","$cartTable","document","ready","timeout","on","$qty","this","undefined","clearTimeout","setTimeout","cart_item_key","cart_item_qty","itemKey","attr","itemQty","val","data","action","security","$minimog","nonce","ajax","url","ajaxurl","type","cache","dataType","beforeSend","setBodyHandling","error","setBodyCompleted","success","response","fragments","each","key","value","replaceWith","body","trigger","handleLazyImages","$form","$submitButton","find","notes","order_notes","setElementHandling","complete","unsetElementHandling","closest","MinimogModal","evt","preventDefault","currentTarget","appendTo","serialize","empty","$newElement","parseHTML","html","$thisButton","wc_add_to_cart_params","getAjaxUrl","output","cart_hash","location","jQuery"],"mappings":"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","file":"../../../woo/cart.min.js","sourcesContent":["(\n\tfunction( $ ) {\n\t\t'use strict';\n\n\t\tvar Helpers = window.minimog.Helpers;\n\n\t\tvar $cartTable = $( '#cart-table-wrap' );\n\n\t\t$( document ).ready( function() {\n\t\t\tinitCart();\n\t\t} );\n\n\t\t$( document.body ).on( 'wc_fragments_loaded wc_fragments_refreshed', function() {\n\t\t\tHelpers.handleLazyImages( $cartTable );\n\t\t\tHelpers.setBodyCompleted();\n\t\t} );\n\n\t\t$( '#modal-cart-order-notes' ).on( 'submit', 'form', save_order_notes );\n\n\t\t$( document ).on( 'submit', 'form.fly-cart-shipping-calculator', shipping_calculator_submit );\n\n\t\t$( document ).on( 'click', '.btn-remove-from-cart', remove_from_cart );\n\n\t\tfunction initCart() {\n\t\t\tvar timeout;\n\t\t\t$cartTable.on( 'change', '.qty', function() {\n\t\t\t\tvar $qty = $( this );\n\n\t\t\t\tif ( timeout !== undefined ) {\n\t\t\t\t\tclearTimeout( timeout );\n\t\t\t\t}\n\n\t\t\t\ttimeout = setTimeout( function() {\n\t\t\t\t\tvar itemKey = $qty.attr( 'name' );\n\t\t\t\t\tvar itemQty = $qty.val();\n\n\t\t\t\t\tupdate_quantity( itemKey, itemQty );\n\t\t\t\t}, 500 );\n\t\t\t} );\n\t\t}\n\n\t\tfunction remove_from_cart( evt ) {\n\t\t\t/**\n\t\t\t * Check if Enable AJAX add to cart buttons on archives.\n\t\t\t */\n\t\t\tif ( typeof wc_add_to_cart_params === 'undefined' ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tevt.preventDefault();\n\n\t\t\tvar $thisButton = $( this );\n\n\t\t\t$.ajax( {\n\t\t\t\ttype: 'POST',\n\t\t\t\turl: Helpers.getAjaxUrl( 'remove_from_cart' ),\n\t\t\t\tdata: {\n\t\t\t\t\tcart_item_key: $thisButton.data( 'cart_item_key' )\n\t\t\t\t},\n\t\t\t\tdataType: 'json',\n\t\t\t\tbeforeSend: function() {\n\t\t\t\t\tHelpers.setBodyHandling();\n\t\t\t\t},\n\t\t\t\tsuccess: function( response ) {\n\t\t\t\t\tif ( ! response || ! response.fragments ) {\n\t\t\t\t\t\twindow.location = $thisButton.attr( 'href' );\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Updated cart content.\n\t\t\t\t\tif ( response.output ) {\n\t\t\t\t\t\t$.each( response.output, function( key, value ) {\n\t\t\t\t\t\t\t$( key ).replaceWith( value );\n\t\t\t\t\t\t} );\n\t\t\t\t\t}\n\n\t\t\t\t\t$( document.body ).trigger( 'removed_from_cart', [\n\t\t\t\t\t\tresponse.fragments,\n\t\t\t\t\t\tresponse.cart_hash,\n\t\t\t\t\t\t$thisButton\n\t\t\t\t\t] );\n\n\t\t\t\t\tHelpers.setBodyCompleted();\n\t\t\t\t\tHelpers.handleLazyImages( $cartTable );\n\t\t\t\t},\n\t\t\t\terror: function() {\n\t\t\t\t\twindow.location = $thisButton.attr( 'href' );\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\n\t\tfunction update_quantity( cart_item_key, cart_item_qty ) {\n\t\t\tvar data = {\n\t\t\t\taction: 'minimog_update_product_quantity',\n\t\t\t\tcart_item_key: cart_item_key,\n\t\t\t\tcart_item_qty: cart_item_qty,\n\t\t\t\tsecurity: $minimog.nonce,\n\t\t\t};\n\n\t\t\t$.ajax( {\n\t\t\t\turl: $minimog.ajaxurl,\n\t\t\t\ttype: 'POST',\n\t\t\t\tcache: false,\n\t\t\t\tdataType: 'json',\n\t\t\t\tdata: data,\n\t\t\t\tbeforeSend: function() {\n\t\t\t\t\tHelpers.setBodyHandling();\n\t\t\t\t},\n\t\t\t\terror: function() {\n\t\t\t\t\tHelpers.setBodyCompleted();\n\t\t\t\t},\n\t\t\t\tsuccess: function( response ) {\n\t\t\t\t\tif ( response.data && response.data.fragments ) {\n\t\t\t\t\t\t$.each( response.data.fragments, function( key, value ) {\n\t\t\t\t\t\t\t$( key ).replaceWith( value );\n\t\t\t\t\t\t} );\n\t\t\t\t\t}\n\n\t\t\t\t\t$( document.body ).trigger( 'minimog_update_qty', [ cart_item_key, cart_item_qty ] );\n\n\t\t\t\t\t$( document.body ).trigger( 'wc_fragment_refresh' );\n\t\t\t\t},\n\t\t\t} );\n\t\t}\n\n\t\tfunction save_order_notes() {\n\t\t\tvar $form = $( this );\n\t\t\tvar $submitButton = $form.find( 'button[type=submit]' );\n\n\t\t\tvar notes = $( this ).find( 'textarea[name=\"order_comments\"]' ).val();\n\n\t\t\tvar data = {\n\t\t\t\taction: 'minimog_save_order_notes',\n\t\t\t\torder_notes: notes,\n\t\t\t};\n\n\t\t\t$.ajax( {\n\t\t\t\ttype: 'POST',\n\t\t\t\turl: $minimog.ajaxurl,\n\t\t\t\tdata: data,\n\t\t\t\tdataType: 'json',\n\t\t\t\tsuccess: function( response ) {\n\t\t\t\t\tif ( response.data && response.data.fragments ) {\n\t\t\t\t\t\t$.each( response.data.fragments, function( key, value ) {\n\t\t\t\t\t\t\t$( key ).replaceWith( value );\n\t\t\t\t\t\t} );\n\t\t\t\t\t}\n\n\t\t\t\t\t// Sync notes on other places.\n\t\t\t\t\t$( 'textarea[name=\"order_comments\"]' ).val( notes );\n\t\t\t\t},\n\t\t\t\tbeforeSend: function() {\n\t\t\t\t\tHelpers.setElementHandling( $submitButton );\n\t\t\t\t},\n\t\t\t\tcomplete: function() {\n\t\t\t\t\tHelpers.unsetElementHandling( $submitButton );\n\t\t\t\t\t$form.closest( '.minimog-modal' ).MinimogModal( 'close' );\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\treturn false;\n\t\t}\n\n\t\t/**\n\t\t * Clone from wc-cart\n\t\t * Handles a shipping calculator form submit.\n\t\t *\n\t\t * @param {Object} evt The JQuery event.\n\t\t */\n\t\tfunction shipping_calculator_submit( evt ) {\n\t\t\tevt.preventDefault();\n\n\t\t\tvar $form = $( evt.currentTarget );\n\n\t\t\t$( '<input />' ).attr( 'type', 'hidden' )\n\t\t\t                .attr( 'name', 'action' )\n\t\t\t                .attr( 'value', 'minimog_calculate_shipping' )\n\t\t\t                .appendTo( $form );\n\n\t\t\t$.ajax( {\n\t\t\t\ttype: $form.attr( 'method' ),\n\t\t\t\turl: $minimog.ajaxurl,\n\t\t\t\tdata: $form.serialize(),\n\t\t\t\tdataType: 'json',\n\t\t\t\tsuccess: function( response ) {\n\t\t\t\t\tif ( response.data.fragments ) {\n\t\t\t\t\t\t$.each( response.data.fragments, function( key, value ) {\n\t\t\t\t\t\t\t$( key ).empty();\n\n\t\t\t\t\t\t\tif ( '' !== value ) {\n\t\t\t\t\t\t\t\t/**\n\t\t\t\t\t\t\t\t * Append only children.\n\t\t\t\t\t\t\t\t * Avoid to use replaceWith to lost \"key\" events\n\t\t\t\t\t\t\t\t */\n\t\t\t\t\t\t\t\tvar $newElement = $( $.parseHTML( value ) );\n\t\t\t\t\t\t\t\t$( key ).html( $newElement.html() );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} );\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tbeforeSend: function() {\n\t\t\t\t\t$form.closest( '.minimog-modal' ).MinimogModal( 'close' );\n\t\t\t\t\tHelpers.setBodyHandling();\n\t\t\t\t},\n\t\t\t\tcomplete: function() {\n\t\t\t\t\tHelpers.setBodyCompleted();\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\t}( jQuery )\n);\n"]}