{"version":3,"sources":["blog-archive.js"],"names":["$","Helpers","window","minimog","filterPostsByUrl","url","loadMore","decodeURIComponent","urlParts","URL","baseUrl","pathname","search","data","history","pushState","getUrlParamsAsObject","$queryVars","action","base_url","$filterWidgets","length","queryVars","jQuery","extend","showingWidgets","$btnLoadMore","each","instance","id","this","attr","$widgetInstance","find","name","push","widgets","ajax","$minimog","ajaxurl","type","dataType","cache","success","response","$gridWrapper","html","children","remove","template","$newItems","parseHTML","MinimogGridLayout","fragments","key","value","empty","$newElement","fn","perfectScrollbar","isHandheld","document","body","trigger","beforeSend","setElementHandling","setBodyHandling","complete","unsetElementHandling","setBodyCompleted","ready","lastST","$window","$el","on","$button","currentST","scrollTop","halfWH","height","parseInt","offset","top","outerHeight","hasClass","evt","preventDefault","href","includes","location","origin"],"mappings":"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","file":"../../blog-archive.min.js","sourcesContent":["/**\n * Functions for archive pages.\n */\n(\n\tfunction( $ ) {\n\t\t'use strict';\n\n\t\tvar Helpers = window.minimog.Helpers;\n\n\t\t$( document ).ready( function() {\n\t\t\thandlerScrollInfinite();\n\n\t\t\t$( document.body ).on( 'click', '.minimog-grid-pagination a.page-numbers', function( evt ) {\n\t\t\t\tevt.preventDefault();\n\n\t\t\t\tvar $link = $( this ),\n\t\t\t\t    href  = $link.attr( 'href' ),\n\t\t\t\t    url   = href.includes( window.location.origin ) ? href : window.location.origin + href;\n\n\t\t\t\tfilterPostsByUrl( url );\n\t\t\t} );\n\n\t\t\t$( document.body ).on( 'click', '.archive-load-more-button', function( evt ) {\n\t\t\t\tevt.preventDefault();\n\n\t\t\t\tvar $button = $( this ),\n\t\t\t\t    href    = $button.attr( 'data-url' ),\n\t\t\t\t    url     = href.includes( window.location.origin ) ? href : window.location.origin + href;\n\n\t\t\t\tfilterPostsByUrl( url, true );\n\t\t\t} );\n\t\t} );\n\n\t\tfunction filterPostsByUrl( url, loadMore = false ) {\n\t\t\turl            = decodeURIComponent( url );\n\t\t\t/**\n\t\t\t * We need send base url to render pagination links.\n\t\t\t */\n\t\t\tconst urlParts = new URL( url );\n\t\t\tvar baseUrl    = urlParts.pathname + urlParts.search;\n\n\t\t\tif ( ! loadMore ) {\n\t\t\t\thistory.pushState( {}, null, url );\n\t\t\t}\n\n\t\t\tvar data = Helpers.getUrlParamsAsObject( url );\n\n\t\t\tdata.action   = 'minimog_get_posts';\n\t\t\tdata.base_url = baseUrl;\n\n\t\t\tvar $queryVars = $( '#minimog-main-post-query' );\n\t\t\tif ( $queryVars.length > 0 ) {\n\t\t\t\tvar queryVars = $queryVars.data( 'query' );\n\t\t\t\tjQuery.extend( data, queryVars );\n\t\t\t}\n\n\t\t\tvar $filterWidgets = $( '.minimog-wp-widget-filter' );\n\n\t\t\tvar showingWidgets = [];\n\n\t\t\t$filterWidgets.each( function() {\n\t\t\t\tvar id              = $( this ).attr( 'id' );\n\t\t\t\tvar $widgetInstance = $( this ).find( '.widget-instance' );\n\n\t\t\t\tif ( $widgetInstance.length > 0 ) {\n\t\t\t\t\tvar instance = $widgetInstance.data( 'instance' );\n\t\t\t\t\tvar name     = $widgetInstance.data( 'name' );\n\n\t\t\t\t\tshowingWidgets.push( {\n\t\t\t\t\t\t'id': '#' + id,\n\t\t\t\t\t\t'name': name,\n\t\t\t\t\t\t'instance': instance\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\tdata.widgets = showingWidgets;\n\n\t\t\tvar $btnLoadMore = $( '.archive-load-more-button' );\n\n\t\t\t$.ajax( {\n\t\t\t\turl: $minimog.ajaxurl,\n\t\t\t\ttype: 'GET',\n\t\t\t\tdata: data,\n\t\t\t\tdataType: 'json',\n\t\t\t\tcache: true,\n\t\t\t\tsuccess: function( response ) {\n\t\t\t\t\tvar $gridWrapper = $( '#minimog-main-post' );\n\n\t\t\t\t\tif ( ! loadMore ) {\n\t\t\t\t\t\t$gridWrapper.children( '.minimog-grid' ).children( '.grid-item' ).remove();\n\t\t\t\t\t}\n\n\t\t\t\t\tvar html      = response.template;\n\t\t\t\t\tvar $newItems = $( $.parseHTML( html ) );\n\n\t\t\t\t\t$gridWrapper.MinimogGridLayout( 'update', $newItems );\n\n\t\t\t\t\tif ( response.fragments ) {\n\t\t\t\t\t\t$.each( response.fragments, function( key, value ) {\n\t\t\t\t\t\t\t$( key ).empty();\n\n\t\t\t\t\t\t\tif ( '' !== value ) {\n\t\t\t\t\t\t\t\t/**\n\t\t\t\t\t\t\t\t * Append only children.\n\t\t\t\t\t\t\t\t * Avoid to use replaceWith to lost \"key\" events\n\t\t\t\t\t\t\t\t */\n\t\t\t\t\t\t\t\tvar $newElement = $( $.parseHTML( value ) );\n\t\t\t\t\t\t\t\t$( key ).html( $newElement.html() );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} );\n\n\t\t\t\t\t\t// Update Widget Scrollable size.\n\t\t\t\t\t\tif ( $.fn.perfectScrollbar && ! Helpers.isHandheld() ) {\n\t\t\t\t\t\t\t$( '.page-sidebar' ).find( '.widget-scrollable' ).each( function() {\n\t\t\t\t\t\t\t\t$( this ).find( '.widget-content-inner' ).perfectScrollbar( 'update' );\n\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t$( document.body ).trigger( 'minimog_get_product_fragments_loaded' );\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tbeforeSend: function() {\n\t\t\t\t\tif ( loadMore ) {\n\t\t\t\t\t\tHelpers.setElementHandling( $btnLoadMore );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tHelpers.setBodyHandling();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tcomplete: function() {\n\t\t\t\t\tif ( loadMore ) {\n\t\t\t\t\t\tHelpers.unsetElementHandling( $btnLoadMore );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tHelpers.setBodyCompleted();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\n\t\tfunction handlerScrollInfinite() {\n\t\t\tvar $el = $( '.minimog-grid-pagination' );\n\n\t\t\tif ( 'infinite' !== $el.data( 'type' ) ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar lastST  = 0;\n\t\t\tvar $window = $( window );\n\n\t\t\t$window.on( 'scroll', function() {\n\t\t\t\tvar currentST = $( this ).scrollTop();\n\n\t\t\t\t// Scroll down only.\n\t\t\t\tif ( currentST > lastST ) {\n\t\t\t\t\tvar windowHeight = $window.height();\n\t\t\t\t\t// 90% window height.\n\t\t\t\t\tvar halfWH       = 90 / 100 * windowHeight;\n\t\t\t\t\thalfWH           = parseInt( halfWH );\n\n\t\t\t\t\tvar elOffsetTop = $el.offset().top;\n\t\t\t\t\tvar elHeight    = $el.outerHeight( true );\n\t\t\t\t\tvar offsetTop   = elOffsetTop + elHeight;\n\t\t\t\t\tvar finalOffset = offsetTop - halfWH;\n\n\t\t\t\t\tif ( currentST >= finalOffset ) {\n\t\t\t\t\t\tvar $button = $el.find( '.archive-load-more-button' );\n\n\t\t\t\t\t\tif ( ! $button.hasClass( 'updating-icon' ) ) {\n\t\t\t\t\t\t\t$button.trigger( 'click' );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tlastST = currentST;\n\t\t\t} );\n\t\t}\n\n\t}( jQuery )\n);\n"]}